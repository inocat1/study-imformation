<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åœ‹ä¸­è‹±èª B5 å–®å­—ç‰¹è¨“</title>
    <style>
        :root {
            --primary: #3b82f6;
            --success: #10b981;
            --error: #ef4444;
            --bg: #f3f4f6;
            --card: #ffffff;
            --text: #1f2937;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            min-height: 100vh;
        }

        .container {
            width: 100%;
            max-width: 600px;
            background: var(--card);
            border-radius: 16px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            padding: 20px;
            position: relative;
            overflow: hidden;
        }

        /* æ¨™é¡Œèˆ‡å°èˆª */
        header {
            text-align: center;
            margin-bottom: 20px;
            border-bottom: 2px solid #e5e7eb;
            padding-bottom: 10px;
        }

        h1 { margin: 0; font-size: 1.5rem; color: var(--primary); }
        .subtitle { color: #6b7280; font-size: 0.9rem; margin-top: 5px; }

        /* è¦–åœ–åˆ‡æ› (éš±è—/é¡¯ç¤º) */
        .view { display: none; }
        .view.active { display: block; }

        /* é¦–é é¸å–®æŒ‰éˆ• */
        .menu-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }
        
        .mode-section {
            background: #f9fafb;
            padding: 15px;
            border-radius: 10px;
            border: 1px solid #e5e7eb;
        }

        .mode-title { font-weight: bold; margin-bottom: 10px; color: #4b5563; }

        button {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.2s;
            background-color: var(--primary);
            color: white;
            font-weight: bold;
            margin-bottom: 8px;
        }

        button:hover { opacity: 0.9; transform: translateY(-1px); }
        button.secondary { background-color: #6b7280; }
        button.outline { background: transparent; border: 2px solid var(--primary); color: var(--primary); }

        /* å–®å­—å¡åˆ—è¡¨æ¨£å¼ */
        .word-list {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            max-height: 60vh;
            overflow-y: auto;
        }
        .word-card {
            background: #eff6ff;
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #bfdbfe;
            cursor: pointer;
        }
        .wc-en { font-weight: bold; font-size: 1.1rem; }
        .wc-zh { font-size: 0.9rem; color: #555; }
        .wc-tag { font-size: 0.7rem; color: var(--primary); margin-bottom: 2px;}

        /* æ¸¬é©—æ¨¡å¼æ¨£å¼ */
        .quiz-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            font-size: 0.9rem;
            color: #6b7280;
        }

        .progress-bar {
            height: 6px;
            background: #e5e7eb;
            border-radius: 3px;
            margin-bottom: 20px;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            background: var(--primary);
            width: 0%;
            transition: width 0.3s;
        }

        .question-card {
            background: #f8fafc;
            padding: 30px;
            border-radius: 12px;
            text-align: center;
            margin-bottom: 20px;
            position: relative;
        }

        .q-word { font-size: 2rem; font-weight: bold; color: var(--text); margin-bottom: 5px; }
        .q-part { font-size: 0.9rem; color: #9ca3af; font-style: italic; }

        .speak-btn {
            background: none;
            border: none;
            color: var(--primary);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 5px;
            width: auto;
            display: inline-block;
        }

        .options-grid { display: grid; gap: 10px; }
        
        .option-btn {
            background: white;
            border: 2px solid #e5e7eb;
            color: var(--text);
            text-align: left;
            padding: 15px;
        }

        .option-btn:hover { background: #f9fafb; border-color: #d1d5db; }
        
        .option-btn.correct { background: #d1fae5; border-color: var(--success); color: #065f46; }
        .option-btn.wrong { background: #fee2e2; border-color: var(--error); color: #991b1b; }

        /* çµæœé é¢ */
        .result-score { font-size: 3rem; font-weight: bold; color: var(--primary); text-align: center; }
        .result-msg { text-align: center; margin-bottom: 20px; color: #6b7280; }

        .back-home { margin-top: 20px; }

    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>åœ‹ä¸­è‹±èª B5 å–®å­—ç‰¹è¨“</h1>
        <div class="subtitle">ç¿°æ—ç‰ˆ L5 ~ L6 ç¸½è¤‡ç¿’</div>
    </header>

    <!-- 1. é¦–é é¸å–® View -->
    <div id="menu-view" class="view active">
        <div class="menu-grid">
            <div class="mode-section">
                <div class="mode-title">ğŸ“– å–®å­—å¡æ¨¡å¼ (åªçœ‹ä¸è€ƒ)</div>
                <button onclick="startStudy('B5-L5')">ç¬¬äº”èª²å–®å­— (L5)</button>
                <button onclick="startStudy('B5-L6')">ç¬¬å…­èª²å–®å­— (L6)</button>
                <button onclick="startStudy('ALL')" class="secondary">å…¨éƒ¨å–®å­—</button>
            </div>

            <div class="mode-section">
                <div class="mode-title">ğŸ“ æ¸¬é©—æ¨¡å¼ (å››é¸ä¸€)</div>
                <button onclick="startQuiz('B5-L5')">æ¸¬é©—ï¼šç¬¬äº”èª²</button>
                <button onclick="startQuiz('B5-L6')">æ¸¬é©—ï¼šç¬¬å…­èª²</button>
                <button onclick="startQuiz('ALL')" class="secondary">æ¸¬é©—ï¼šå…¨éƒ¨æ··å’Œ</button>
            </div>
        </div>
    </div>

    <!-- 2. å–®å­—å¡åˆ—è¡¨ View -->
    <div id="study-view" class="view">
        <button onclick="showMenu()" class="outline" style="margin-bottom:15px;">â† å›é¸å–®</button>
        <div id="study-list" class="word-list">
            <!-- JS æœƒå¡å…¥å–®å­—å¡ -->
        </div>
    </div>

    <!-- 3. æ¸¬é©— View -->
    <div id="quiz-view" class="view">
        <div class="quiz-header">
            <span id="quiz-progress">1 / 10</span>
            <span id="quiz-score">Score: 0</span>
        </div>
        <div class="progress-bar"><div id="progress-fill" class="progress-fill"></div></div>

        <div class="question-card">
            <div id="q-word" class="q-word">Word</div>
            <button class="speak-btn" onclick="speakCurrent()">ğŸ”Š</button>
        </div>

        <div id="options-container" class="options-grid">
            <!-- JS æœƒå¡å…¥é¸é … -->
        </div>

        <button onclick="showMenu()" class="outline" style="margin-top:20px;">é€€å‡ºæ¸¬é©—</button>
    </div>

    <!-- 4. çµæœ View -->
    <div id="result-view" class="view">
        <div class="result-score" id="final-score">100</div>
        <div class="result-msg">æ¸¬é©—çµæŸï¼</div>
        <div id="wrong-list" class="word-list" style="margin-bottom:20px;"></div>
        <button onclick="showMenu()" class="back-home">å›é¦–é </button>
    </div>

</div>

<script>
    // ================= è³‡æ–™åº« (JSON) =================
    const wordData = [
        // B5-L5
        { t: "B5-L5", en: "arrive", zh: "æŠµé”" },
        { t: "B5-L5", en: "planet", zh: "è¡Œæ˜Ÿ" },
        { t: "B5-L5", en: "appear", zh: "å‡ºç¾" },
        { t: "B5-L5", en: "camera", zh: "ç›¸æ©Ÿ" },
        { t: "B5-L5", en: "restroom", zh: "æ´—æ‰‹é–“" },
        { t: "B5-L5", en: "bath", zh: "æ²æµ´" },
        { t: "B5-L5", en: "uniform", zh: "åˆ¶æœ" },
        { t: "B5-L5", en: "tail", zh: "å°¾å·´" },
        { t: "B5-L5", en: "bottom", zh: "è‡€éƒ¨; åº•éƒ¨" },
        { t: "B5-L5", en: "main", zh: "ä¸»è¦çš„" },
        { t: "B5-L5", en: "notice", zh: "æ³¨æ„åˆ°" },
        { t: "B5-L5", en: "belong", zh: "å±¬æ–¼" },
        { t: "B5-L5", en: "square", zh: "æ­£æ–¹å½¢çš„" },
        { t: "B5-L5", en: "string", zh: "ä¸²; ç·š" },
        { t: "B5-L5", en: "round", zh: "åœ“å½¢çš„" },
        { t: "B5-L5", en: "dot", zh: "åœ“é»" },
        { t: "B5-L5", en: "bow", zh: "è´è¶çµ" },
        { t: "B5-L5", en: "pin", zh: "èƒ¸é‡" },
        { t: "B5-L5", en: "neighbor", zh: "é„°å±…" },
        { t: "B5-L5", en: "foreigner", zh: "å¤–åœ‹äºº" },
        { t: "B5-L5", en: "hobby", zh: "å—œå¥½" },
        { t: "B5-L5", en: "businessman", zh: "å•†äºº" },
        { t: "B5-L5", en: "business", zh: "ç”Ÿæ„" },
        { t: "B5-L5", en: "dictionary", zh: "å­—å…¸" },
        { t: "B5-L5", en: "workbook", zh: "ä½œæ¥­æœ¬" },
        { t: "B5-L5", en: "born", zh: "å‡ºç”Ÿçš„" },
        { t: "B5-L5", en: "be no stranger to", zh: "å°...ä¸é™Œç”Ÿ" },
        { t: "B5-L5", en: "prize", zh: "ç" },
        { t: "B5-L5", en: "topic", zh: "ä¸»é¡Œ" },
        { t: "B5-L5", en: "knowledge", zh: "çŸ¥è­˜" },
        { t: "B5-L5", en: "public", zh: "å…¬çœ¾çš„" },
        { t: "B5-L5", en: "go on", zh: "ç™¼ç”Ÿ" },
        { t: "B5-L5", en: "lead", zh: "é€šå¾€" },
        { t: "B5-L5", en: "play", zh: "æ‰®æ¼”" },
        { t: "B5-L5", en: "exercise", zh: "ç¿’é¡Œ" },
        { t: "B5-L5", en: "comic book convention", zh: "æ¼«ç•«å±•" },
        { t: "B5-L5", en: "booth", zh: "æ”¤ä½" },
        { t: "B5-L5", en: "character", zh: "è§’è‰²" },
        { t: "B5-L5", en: "hug", zh: "æ“æŠ±" },
        { t: "B5-L5", en: "describe", zh: "æè¿°" },
        { t: "B5-L5", en: "noun", zh: "åè©" },
        { t: "B5-L5", en: "pearl", zh: "çç " },
        { t: "B5-L5", en: "cosplayer", zh: "è§’è‰²æ‰®æ¼”è€…" },

        // B5-L6
        { t: "B5-L6", en: "apartment", zh: "å…¬å¯“" },
        { t: "B5-L6", en: "glad", zh: "é«˜èˆˆçš„" },
        { t: "B5-L6", en: "town", zh: "å°é®" },
        { t: "B5-L6", en: "polite", zh: "æœ‰ç¦®è²Œçš„" },
        { t: "B5-L6", en: "seat", zh: "åº§ä½" },
        { t: "B5-L6", en: "beside", zh: "åœ¨â€¦æ—é‚Š" },
        { t: "B5-L6", en: "except", zh: "é™¤äº†" },
        { t: "B5-L6", en: "blank", zh: "ç©ºç™½çš„" },
        { t: "B5-L6", en: "present", zh: "ç¦®ç‰©" },
        { t: "B5-L6", en: "invite", zh: "é‚€è«‹" },
        { t: "B5-L6", en: "perhaps", zh: "ä¹Ÿè¨±" },
        { t: "B5-L6", en: "side", zh: "å´é¢" },
        { t: "B5-L6", en: "sidewalk", zh: "äººè¡Œé“" },
        { t: "B5-L6", en: "blind", zh: "ç›²çš„" },
        { t: "B5-L6", en: "April foolâ€™s day", zh: "æ„šäººç¯€" },
        { t: "B5-L6", en: "tape", zh: "ç”¨è† å¸¶é»" },
        { t: "B5-L6", en: "paper", zh: "ç´™" },
        { t: "B5-L6", en: "joke", zh: "ç¬‘è©±" },
        { t: "B5-L6", en: "visitor", zh: "éŠå®¢; è¨ªå®¢" },
        { t: "B5-L6", en: "somewhere", zh: "åœ¨æŸè™•" },
        { t: "B5-L6", en: "mud", zh: "æ³¥å·´" },
        { t: "B5-L6", en: "ahead", zh: "åœ¨å‰æ–¹" },
        { t: "B5-L6", en: "heat", zh: "é«˜æº«; åŠ ç†±" },
        { t: "B5-L6", en: "rise", zh: "å‡èµ·" },
        { t: "B5-L6", en: "lazy", zh: "æ‡¶æƒ°" },
        { t: "B5-L6", en: "have bigger fish to fry", zh: "æœ‰æ›´é‡è¦çš„äº‹è¦åš" },
        { t: "B5-L6", en: "smoke", zh: "ç…™éœ§; æŠ½è¸" },
        { t: "B5-L6", en: "cover", zh: "è¦†è“‹" },
        { t: "B5-L6", en: "used to", zh: "éå»æ™‚å¸¸" },
        { t: "B5-L6", en: "appear", zh: "ä¼¼ä¹" },
        { t: "B5-L6", en: "lie", zh: "èºº" },
        { t: "B5-L6", en: "draw", zh: "æå–" },
        { t: "B5-L6", en: "spell", zh: "å’’èª" },
        { t: "B5-L6", en: "France", zh: "æ³•åœ‹" },
        { t: "B5-L6", en: "worthless", zh: "æ²’æœ‰åƒ¹å€¼çš„" },
        { t: "B5-L6", en: "chat", zh: "èŠå¤©" },
        { t: "B5-L6", en: "resist", zh: "æŠµæŠ—" },
        { t: "B5-L6", en: "Braille", zh: "ç›²äººé»å­—æ³•" },
        { t: "B5-L6", en: "the Louvre", zh: "ç¾…æµ®å®®" },
        { t: "B5-L6", en: "complain", zh: "æŠ±æ€¨" },
        { t: "B5-L6", en: "fairy", zh: "ç²¾éˆ; ä»™å­" },
        { t: "B5-L6", en: "jewel", zh: "å¯¶çŸ³" }
    ];

    // ================= ç¨‹å¼é‚è¼¯ (JavaScript) =================

    // è®Šæ•¸
    let currentQuizList = [];
    let currentIndex = 0;
    let score = 0;
    let wrongAnswers = [];
    let isAnswered = false;

    // 1. åˆ‡æ›ç•«é¢
    function switchView(viewId) {
        document.querySelectorAll('.view').forEach(el => el.classList.remove('active'));
        document.getElementById(viewId).classList.add('active');
    }

    function showMenu() {
        switchView('menu-view');
    }

    // 2. å–®å­—å¡æ¨¡å¼
    function startStudy(tag) {
        let list = wordData;
        if (tag !== 'ALL') {
            list = wordData.filter(item => item.t === tag);
        }

        const container = document.getElementById('study-list');
        container.innerHTML = "";
        
        list.forEach(item => {
            container.innerHTML += `
                <div class="word-card" onclick="speakText('${item.en}')">
                    <div class="wc-tag">${item.t}</div>
                    <div class="wc-en">${item.en}</div>
                    <div class="wc-zh">${item.zh}</div>
                </div>
            `;
        });
        switchView('study-view');
    }

    // 3. æ¸¬é©—æ¨¡å¼
    function startQuiz(tag) {
        // ç¯©é¸é¡Œç›®
        if (tag === 'ALL') {
            currentQuizList = [...wordData];
        } else {
            currentQuizList = wordData.filter(item => item.t === tag);
        }
        
        // æ´—ç‰Œ
        shuffle(currentQuizList);

        // åˆå§‹åŒ–
        currentIndex = 0;
        score = 0;
        wrongAnswers = [];
        isAnswered = false;
        
        loadQuestion();
        switchView('quiz-view');
    }

    function loadQuestion() {
        if (currentIndex >= currentQuizList.length) {
            showResult();
            return;
        }

        isAnswered = false;
        const q = currentQuizList[currentIndex];
        
        // æ›´æ–°é€²åº¦èˆ‡åˆ†æ•¸
        document.getElementById('quiz-progress').innerText = `${currentIndex + 1} / ${currentQuizList.length}`;
        document.getElementById('quiz-score').innerText = `Score: ${score}`;
        const pct = ((currentIndex) / currentQuizList.length) * 100;
        document.getElementById('progress-fill').style.width = `${pct}%`;

        // é¡¯ç¤ºé¡Œç›®
        document.getElementById('q-word').innerText = q.en;

        // ç”¢ç”Ÿé¸é … (1æ­£è§£ + 3éŒ¯èª¤)
        let options = [q];
        let distractors = wordData.filter(x => x.en !== q.en); // å–å¾—æ‰€æœ‰éæ­£ç¢ºç­”æ¡ˆ
        shuffle(distractors);
        options.push(...distractors.slice(0, 3)); // æŠ“3å€‹
        shuffle(options); // é¸é …å†æ´—ç‰Œ

        // æ¸²æŸ“æŒ‰éˆ•
        const optContainer = document.getElementById('options-container');
        optContainer.innerHTML = "";
        
        options.forEach(opt => {
            const btn = document.createElement('button');
            btn.className = 'option-btn';
            btn.innerText = opt.zh;
            btn.onclick = () => checkAnswer(opt, q, btn);
            optContainer.appendChild(btn);
        });
        
        // è‡ªå‹•ç™¼éŸ³
        //speakText(q.en);
    }

    function checkAnswer(selected, correct, btn) {
        if (isAnswered) return; // é˜²æ­¢é€£é»
        isAnswered = true;

        const allBtns = document.querySelectorAll('.option-btn');
        
        if (selected.en === correct.en) {
            // ç­”å°
            score++;
            btn.classList.add('correct');
        } else {
            // ç­”éŒ¯
            btn.classList.add('wrong');
            wrongAnswers.push(correct);
            // æ¨™ç¤ºæ­£ç¢ºç­”æ¡ˆ
            allBtns.forEach(b => {
                if (b.innerText === correct.zh) b.classList.add('correct');
            });
        }

        // å»¶é²è·³ä¸‹ä¸€é¡Œ
        setTimeout(() => {
            currentIndex++;
            loadQuestion();
        }, 1200);
    }

    function showResult() {
        document.getElementById('final-score').innerText = score;
        const wrongList = document.getElementById('wrong-list');
        wrongList.innerHTML = "";
        
        if (wrongAnswers.length > 0) {
            wrongList.innerHTML = "<h3>ğŸ’¡ éœ€è¤‡ç¿’çš„å–®å­—ï¼š</h3>";
            wrongAnswers.forEach(item => {
                wrongList.innerHTML += `
                    <div class="word-card" style="border-color:#fca5a5; background:#fef2f2;">
                        <div class="wc-en">${item.en}</div>
                        <div class="wc-zh">${item.zh}</div>
                    </div>
                `;
            });
        } else {
            wrongList.innerHTML = "<h3>ğŸ‰ å¤ªå¼·äº†ï¼å…¨éƒ¨ç­”å°ï¼</h3>";
        }

        switchView('result-view');
    }

    // å·¥å…·å‡½å¼ï¼šæ´—ç‰Œ (Fisher-Yates)
    function shuffle(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
    }

    // å·¥å…·å‡½å¼ï¼šç™¼éŸ³
    function speakCurrent() {
        const word = document.getElementById('q-word').innerText;
        speakText(word);
    }

    function speakText(text) {
        window.speechSynthesis.cancel();
        
        const utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = 'en-US';
        utterance.volume = 0.5;  
        window.speechSynthesis.speak(utterance);
    }

</script>

</body>
</html>
